import St from"react";import It from"react-dom/client";import{useState as G,useEffect as J}from"react";import{Toaster as Ct,toast as Nt}from"sonner";import{useState as q,useEffect as dt}from"react";import{useState as E,useEffect as B}from"react";import{toast as ct}from"sonner";var L=null;async function h(){if(L)return L;try{let e=await fetch("/data/products.json");if(!e.ok)throw new Error("Failed to load products data");return L=await e.json(),L}catch(e){throw console.error("Error loading products data:",e),e}}var R=class{async getAllProducts(){return(await h()).products.filter(t=>t.status==="active")}async getProduct(i){return(await h()).products.find(r=>r.id===i&&r.status==="active")||null}async getProductWithVariants(i){let t=await h(),r=t.products.find(c=>c.id===i&&c.status==="active");if(!r)return null;let o=t.dimensions.filter(c=>c.product_id===i).sort((c,n)=>c.display_order-n.display_order).map(c=>({...c,values:t.dimension_values.filter(n=>n.dimension_id===c.id&&n.active).sort((n,a)=>n.display_order-a.display_order)})),l=t.variants.filter(c=>c.product_id===i&&c.active).map(c=>({...c,attributes:t.variant_attributes.filter(n=>n.variant_id===c.id)}));return{product:r,dimensions:o,variants:l}}async getAllProductsWithVariants(){let t=(await h()).products.filter(o=>o.status==="active"),r=[];for(let o of t){let l=await this.getProductWithVariants(o.id);l&&r.push(l)}return r}async getVariant(i){return(await h()).variants.find(r=>r.id===i&&r.active)||null}async getVariantWithProduct(i){let t=await h(),r=t.variants.find(l=>l.id===i&&l.active);if(!r)return null;let o=t.products.find(l=>l.id===r.product_id&&l.status==="active");return o?{variant:r,product:o}:null}async findVariantBySelections(i,t){let r=await h(),o=r.variants.filter(l=>l.product_id===i&&l.active);for(let l of o){let c=r.variant_attributes.filter(a=>a.variant_id===l.id),n=!0;for(let[a,s]of Object.entries(t))if(!c.some(u=>u.dimension_id===a&&u.dimension_value_id===s)){n=!1;break}if(n&&Object.keys(t).length===c.length)return{variant:l,selections:t}}return null}async getAvailableValuesForDimension(i,t,r){let o=await h(),c=o.variants.filter(a=>a.product_id===i&&a.active).filter(a=>{let s=o.variant_attributes.filter(p=>p.variant_id===a.id);for(let[p,u]of Object.entries(r)){if(p===t)continue;if(!s.some(V=>V.dimension_id===p&&V.dimension_value_id===u))return!1}return!0}),n=new Set;for(let a of c){let p=o.variant_attributes.filter(u=>u.variant_id===a.id).find(u=>u.dimension_id===t);p&&n.add(p.dimension_value_id)}return o.dimension_values.filter(a=>a.dimension_id===t&&a.active&&n.has(a.id)).sort((a,s)=>a.display_order-s.display_order)}async checkInventory(i){let r=(await h()).variants.find(o=>o.id===i&&o.active);return r?r.inventory_tracking?{available:r.inventory_quantity>0,quantity:r.inventory_quantity}:{available:!0,quantity:1/0}:{available:!1,quantity:0}}},k=new R;import{jsx as v,jsxs as N}from"react/jsx-runtime";var lt=({productWithVariants:e,addToCart:i})=>{let{product:t,dimensions:r,variants:o}=e,[l,c]=E(0),[n,a]=E({}),[s,p]=E(null),[u,O]=E({});B(()=>{V()},[n]),B(()=>{Object.keys(n).length===r.length?et():p(null)},[n,r]);let V=async()=>{let m={};for(let d of r){let b={...n};delete b[d.id];let C=await k.getAvailableValuesForDimension(t.id,d.id,b);m[d.id]=C}O(m)},et=async()=>{let m=await k.findVariantBySelections(t.id,n);p(m)},rt=(m,d)=>{a(b=>({...b,[m]:d}))},at=()=>{if(s)return new Intl.NumberFormat("en-US",{style:"currency",currency:s.variant.currency}).format(s.variant.price/100);let m=o.map(C=>C.price),d=Math.min(...m),b=Math.max(...m);return d===b?new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(d/100):`${new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(d/100)} - ${new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(b/100)}`},W=()=>s?s.variant.inventory_tracking?s.variant.inventory_quantity<=0:!1:!0,nt=()=>{if(!s){let m=r.filter(d=>!n[d.id]).map(d=>d.name);return m.length>0?`Select ${m.join(", ")}`:"Select Options"}return s.variant.inventory_tracking&&s.variant.inventory_quantity<=0?"Out of Stock":"Add to Cart"},ot=()=>{if(!s)return;let m={variant:s.variant,product:t,selections:n,quantity:1};i(m);let d=r.map(C=>{let it=n[C.id],$=u[C.id]?.find(st=>st.id===it);return $?`${C.name.toLowerCase()} ${$.value.toLowerCase()}`:null}).filter(Boolean).join(", "),b=d?`Added ${t.name} (${d}) to cart!`:`Added ${t.name} to cart!`;ct.success(b)};return N("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden flex flex-col transition-transform duration-300 hover:scale-105",children:[N("div",{className:"relative",children:[v("img",{src:t.images[l],alt:`${t.name} - view ${l+1}`,className:"w-full h-80 object-cover"}),t.images.length>1&&v("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex space-x-2",children:t.images.map((m,d)=>v("button",{onClick:()=>c(d),className:`h-2 w-2 rounded-full transition-colors ${l===d?"bg-white":"bg-white/50 hover:bg-white"}`,"aria-label":`View image ${d+1}`},d))})]}),N("div",{className:"p-6 flex flex-col flex-grow",children:[v("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),v("p",{className:"text-lg font-semibold text-brand-teal mt-1",children:at()}),v("p",{className:"text-gray-600 mt-2",children:t.description}),v("div",{className:"mt-4 space-y-4",children:r.map(m=>N("div",{children:[N("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[m.name,m.required&&v("span",{className:"text-red-500 ml-1",children:"*"})]}),N("select",{value:n[m.id]||"",onChange:d=>rt(m.id,d.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-blue focus:border-transparent",required:m.required,children:[N("option",{value:"",children:["Select ",m.name]}),(u[m.id]||[]).map(d=>v("option",{value:d.id,children:d.value},d.id))]})]},m.id))}),s&&s.variant.inventory_tracking&&v("div",{className:"mt-2",children:v("p",{className:`text-sm ${s.variant.inventory_quantity>0?s.variant.inventory_quantity<=5?"text-yellow-600":"text-green-600":"text-red-600"}`,children:s.variant.inventory_quantity>0?s.variant.inventory_quantity<=5?`Only ${s.variant.inventory_quantity} left in stock`:`${s.variant.inventory_quantity} in stock`:"Out of stock"})}),v("button",{onClick:ot,disabled:W(),className:`mt-4 w-full font-bold py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue ${W()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-opacity-90"}`,children:nt()})]})]})},F=lt;import{jsx as x,jsxs as A}from"react/jsx-runtime";var ut=({addToCart:e})=>{let[i,t]=q([]),[r,o]=q(!0),[l,c]=q(null);dt(()=>{n()},[]);let n=async()=>{try{o(!0);let a=await k.getAllProductsWithVariants();t(a),c(null)}catch(a){console.error("Error loading products:",a),c("Failed to load products. Please try again later.")}finally{o(!1)}};return r?A("div",{className:"text-center py-12",children:[x("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"}),x("p",{className:"mt-2 text-gray-600",children:"Loading products..."})]}):l?A("div",{className:"text-center py-12",children:[x("p",{className:"text-red-600 mb-4",children:l}),x("button",{onClick:n,className:"bg-brand-blue text-white px-4 py-2 rounded-md hover:bg-opacity-90 transition-colors",children:"Try Again"})]}):i.length===0?x("div",{className:"text-center py-12",children:x("p",{className:"text-gray-600",children:"No products available at the moment."})}):A("div",{children:[x("h2",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:"Our Gear"}),x("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:i.map(a=>x(F,{productWithVariants:a,addToCart:e},a.product.id))})]})},M=ut;import yt,{useEffect as gt,useMemo as bt}from"react";import{jsx as g,jsxs as S}from"react/jsx-runtime";var mt=({item:e,onRemove:i,onUpdateQuantity:t})=>{let r=n=>{let a=parseInt(n.target.value,10);!isNaN(a)&&a>0&&t(e.variant.id,a)},o=()=>t(e.variant.id,e.quantity+1),l=()=>{e.quantity>1?t(e.variant.id,e.quantity-1):i(e.variant.id)},c=()=>{let n=Object.values(e.selections);return n.length>0?`${e.product.name} - ${n.join(" - ")}`:e.product.name};return S("div",{className:"flex items-center space-x-4 border-b pb-4",children:[g("img",{src:e.product.images[0],alt:e.product.name,className:"w-20 h-20 object-cover rounded-md"}),S("div",{className:"flex-grow",children:[g("h4",{className:"font-bold",children:c()}),S("p",{className:"text-xs text-gray-500 mb-1",children:["SKU: ",e.variant.sku]}),g("p",{className:"text-sm text-gray-600",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.variant.currency}).format(e.variant.price/100)}),Object.keys(e.selections).length>0&&g("div",{className:"text-xs text-gray-500 mt-1",children:Object.entries(e.selections).map(([n,a])=>g("span",{className:"inline-block mr-2",children:a},n))}),S("div",{className:"flex items-center mt-2",children:[g("button",{onClick:l,className:"w-6 h-6 border rounded-l-md hover:bg-gray-50 flex items-center justify-center",children:"-"}),g("input",{type:"number",value:e.quantity,onChange:r,className:"w-10 h-6 text-center border-t border-b focus:outline-none",min:"1"}),g("button",{onClick:o,className:"w-6 h-6 border rounded-r-md hover:bg-gray-50 flex items-center justify-center",children:"+"})]})]}),S("div",{className:"text-right",children:[g("p",{className:"font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.variant.currency}).format(e.variant.price*e.quantity/100)}),g("button",{onClick:()=>i(e.variant.id),className:"text-sm text-red-500 hover:underline mt-1",children:"Remove"})]})]})},D=mt;import{jsx as j}from"react/jsx-runtime";var pt=()=>j("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:j("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),U=pt;import{loadStripe as ft}from"@stripe/stripe-js";var T=window.STRIPE_PUBLISHABLE_KEY||"";T.startsWith("pk_")||console.error("Stripe publishable key is not set or is invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file.");var vt=ft(T),H=async e=>{let i=await vt;if(!i){console.error("Stripe.js has not loaded yet."),alert("Error: Payment system is not available. Please try again later.");return}if(!T.startsWith("pk_")){console.error("Stripe publishable key is not defined or invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file."),alert("Error: Payment system is not configured. Please contact support.");return}let t=e.filter(o=>!o.price||!o.price.startsWith("price_"));if(t.length>0){console.error("Some items don't have valid Stripe price IDs:",t),alert("Error: Some items in your cart are not properly configured for checkout. Please try again or contact support.");return}let{error:r}=await i.redirectToCheckout({lineItems:e,mode:"payment",successUrl:`${window.location.origin}/merchandise/?session_id={CHECKOUT_SESSION_ID}`,cancelUrl:`${window.location.origin}/merchandise/`});r&&(console.error("Stripe checkout error:",r),alert(`An error occurred during checkout: ${r.message}`))};import{Fragment as K,jsx as y,jsxs as w}from"react/jsx-runtime";var ht=({isOpen:e,onClose:i,items:t,removeFromCart:r,updateQuantity:o,getTotalPrice:l})=>{let[c,n]=yt.useState(!1);gt(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[e]);let a=bt(()=>l()/100,[l]),s=async()=>{n(!0);let p=t.map(u=>({price:u.variant.stripe_price_id,quantity:u.quantity}));await H(p),n(!1)};return w(K,{children:[y("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i,"aria-hidden":"true"}),y("div",{className:`fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform transition-transform duration-300 ${e?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"cart-heading",children:w("div",{className:"flex flex-col h-full",children:[w("div",{className:"flex justify-between items-center p-6 border-b",children:[y("h2",{id:"cart-heading",className:"text-2xl font-bold text-brand-blue",children:"Shopping Cart"}),w("button",{onClick:i,className:"text-gray-500 hover:text-gray-800 transition-colors",children:[y(U,{}),y("span",{className:"sr-only",children:"Close cart"})]})]}),t.length===0?w("div",{className:"flex-grow flex flex-col justify-center items-center text-center p-6",children:[y("p",{className:"text-gray-600 text-lg",children:"Your cart is empty."}),y("button",{onClick:i,className:"mt-4 text-brand-teal font-semibold hover:underline",children:"Continue Shopping"})]}):w(K,{children:[y("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:t.map(p=>y(D,{item:p,onRemove:r,onUpdateQuantity:o},p.variant.id))}),w("div",{className:"p-6 border-t space-y-4",children:[w("div",{className:"flex justify-between font-bold text-lg",children:[y("span",{children:"Subtotal"}),y("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)})]}),y("button",{onClick:s,disabled:c,className:"w-full bg-brand-blue text-white font-bold py-3 px-4 rounded-md hover:bg-opacity-90 transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?"Processing...":"Proceed to Checkout"})]})]})]})})]})},Y=ht;import{jsx as f,jsxs as I}from"react/jsx-runtime";var xt=({sessionId:e,onClose:i})=>f("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-8 animate-fadeIn",children:I("div",{className:"text-center",children:[f("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4",children:f("svg",{className:"h-10 w-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),f("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),f("p",{className:"text-gray-600 mb-6",children:"Thank you for your order. Your payment has been processed successfully."}),I("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[f("p",{className:"text-sm text-gray-500 mb-1",children:"Order Reference"}),f("p",{className:"text-xs font-mono text-gray-700 break-all",children:e})]}),I("div",{className:"space-y-3 text-left text-sm text-gray-600 mb-6",children:[I("div",{className:"flex items-start",children:[f("svg",{className:"h-5 w-5 text-brand-teal mr-2 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),f("span",{children:"A confirmation email has been sent to your email address"})]}),I("div",{className:"flex items-start",children:[f("svg",{className:"h-5 w-5 text-brand-teal mr-2 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f("span",{children:"You can use the order reference above to track your order"})]})]}),f("button",{onClick:i,className:"w-full bg-brand-blue hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200",children:"Continue Shopping"})]})})}),z=xt;import{useState as wt,useCallback as P}from"react";var Q=()=>{let[e,i]=wt([]),t=P(a=>{i(s=>s.find(u=>u.variant.id===a.variant.id)?s.map(u=>u.variant.id===a.variant.id?{...u,quantity:u.quantity+a.quantity}:u):[...s,a])},[]),r=P(a=>{i(s=>s.filter(p=>p.variant.id!==a))},[]),o=P((a,s)=>{if(s<=0){r(a);return}i(p=>p.map(u=>u.variant.id===a?{...u,quantity:s}:u))},[r]),l=P(()=>{i([])},[]),c=P(()=>e.reduce((a,s)=>a+s.variant.price*s.quantity,0),[e]),n=P(()=>e.reduce((a,s)=>a+s.quantity,0),[e]);return{items:e,addToCart:t,removeFromCart:r,updateQuantity:o,clearCart:l,getTotalPrice:c,getTotalItems:n}};import{jsx as _,jsxs as kt}from"react/jsx-runtime";var Pt=()=>{let[e,i]=G(!1),[t,r]=G(null),o=Q();return J(()=>{let l=document.getElementById("header-cart-btn"),c=document.getElementById("cart-count");if(l){let n=()=>i(!0);return l.addEventListener("click",n),c&&(c.textContent=o.getTotalItems().toString(),o.getTotalItems()>0?c.classList.remove("hidden"):c.classList.add("hidden")),()=>{l.removeEventListener("click",n)}}},[o.getTotalItems]),J(()=>{let c=new URLSearchParams(window.location.search).get("session_id");if(c){o.clearCart(),r(c),Nt.success("Payment successful! Thank you for your order.");let n=new URL(window.location.href);n.searchParams.delete("session_id"),window.history.replaceState({},"",n.toString())}},[o]),kt("div",{className:"font-sans antialiased text-gray-800",children:[_(Ct,{position:"top-right",toastOptions:{style:{background:"#004a8f",color:"white",fontSize:"16px",fontWeight:"600",padding:"16px 20px",borderRadius:"12px",boxShadow:"0 10px 25px rgba(0, 74, 143, 0.3)"}},duration:4e3}),_("main",{children:_(M,{addToCart:o.addToCart})}),_(Y,{isOpen:e,onClose:()=>i(!1),...o}),t&&_(z,{sessionId:t,onClose:()=>r(null)})]})},X=Pt;import{jsx as Z}from"react/jsx-runtime";var tt=document.getElementById("merch-root");if(!tt)throw new Error("Could not find root element to mount to");var _t=It.createRoot(tt);_t.render(Z(St.StrictMode,{children:Z(X,{})}));
