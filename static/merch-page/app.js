import wt from"react";import Ct from"react-dom/client";import{useState as yt,useEffect as gt}from"react";import{Toaster as bt}from"sonner";import{useState as q,useEffect as it}from"react";import{useState as k,useEffect as W}from"react";import{toast as at}from"sonner";var S=null;async function b(){if(S)return S;try{let r=await fetch("/data/products.json");if(!r.ok)throw new Error("Failed to load products data");return S=await r.json(),S}catch(r){throw console.error("Error loading products data:",r),r}}var E=class{async getAllProducts(){return(await b()).products.filter(t=>t.status==="active")}async getProduct(i){return(await b()).products.find(e=>e.id===i&&e.status==="active")||null}async getProductWithVariants(i){let t=await b(),e=t.products.find(l=>l.id===i&&l.status==="active");if(!e)return null;let o=t.dimensions.filter(l=>l.product_id===i).sort((l,s)=>l.display_order-s.display_order).map(l=>({...l,values:t.dimension_values.filter(s=>s.dimension_id===l.id&&s.active).sort((s,a)=>s.display_order-a.display_order)})),c=t.variants.filter(l=>l.product_id===i&&l.active).map(l=>({...l,attributes:t.variant_attributes.filter(s=>s.variant_id===l.id)}));return{product:e,dimensions:o,variants:c}}async getAllProductsWithVariants(){let t=(await b()).products.filter(o=>o.status==="active"),e=[];for(let o of t){let c=await this.getProductWithVariants(o.id);c&&e.push(c)}return e}async getVariant(i){return(await b()).variants.find(e=>e.id===i&&e.active)||null}async getVariantWithProduct(i){let t=await b(),e=t.variants.find(c=>c.id===i&&c.active);if(!e)return null;let o=t.products.find(c=>c.id===e.product_id&&c.status==="active");return o?{variant:e,product:o}:null}async findVariantBySelections(i,t){let e=await b(),o=e.variants.filter(c=>c.product_id===i&&c.active);for(let c of o){let l=e.variant_attributes.filter(a=>a.variant_id===c.id),s=!0;for(let[a,n]of Object.entries(t))if(!l.some(u=>u.dimension_id===a&&u.dimension_value_id===n)){s=!1;break}if(s&&Object.keys(t).length===l.length)return{variant:c,selections:t}}return null}async getAvailableValuesForDimension(i,t,e){let o=await b(),l=o.variants.filter(a=>a.product_id===i&&a.active).filter(a=>{let n=o.variant_attributes.filter(p=>p.variant_id===a.id);for(let[p,u]of Object.entries(e)){if(p===t)continue;if(!n.some(I=>I.dimension_id===p&&I.dimension_value_id===u))return!1}return!0}),s=new Set;for(let a of l){let p=o.variant_attributes.filter(u=>u.variant_id===a.id).find(u=>u.dimension_id===t);p&&s.add(p.dimension_value_id)}return o.dimension_values.filter(a=>a.dimension_id===t&&a.active&&s.has(a.id)).sort((a,n)=>a.display_order-n.display_order)}async checkInventory(i){let e=(await b()).variants.find(o=>o.id===i&&o.active);return e?e.inventory_tracking?{available:e.inventory_quantity>0,quantity:e.inventory_quantity}:{available:!0,quantity:1/0}:{available:!1,quantity:0}}},N=new E;import{jsx as f,jsxs as C}from"react/jsx-runtime";var nt=({productWithVariants:r,addToCart:i})=>{let{product:t,dimensions:e,variants:o}=r,[c,l]=k(0),[s,a]=k({}),[n,p]=k(null),[u,R]=k({});W(()=>{I()},[s]),W(()=>{Object.keys(s).length===e.length?G():p(null)},[s,e]);let I=async()=>{let m={};for(let d of e){let g={...s};delete g[d.id];let w=await N.getAvailableValuesForDimension(t.id,d.id,g);m[d.id]=w}R(m)},G=async()=>{let m=await N.findVariantBySelections(t.id,s);p(m)},J=(m,d)=>{a(g=>({...g,[m]:d}))},X=()=>{if(n)return new Intl.NumberFormat("en-US",{style:"currency",currency:n.variant.currency}).format(n.variant.price/100);let m=o.map(w=>w.price),d=Math.min(...m),g=Math.max(...m);return d===g?new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(d/100):`${new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(d/100)} - ${new Intl.NumberFormat("en-US",{style:"currency",currency:o[0].currency}).format(g/100)}`},T=()=>n?n.variant.inventory_tracking?n.variant.inventory_quantity<=0:!1:!0,Z=()=>{if(!n){let m=e.filter(d=>!s[d.id]).map(d=>d.name);return m.length>0?`Select ${m.join(", ")}`:"Select Options"}return n.variant.inventory_tracking&&n.variant.inventory_quantity<=0?"Out of Stock":"Add to Cart"},tt=()=>{if(!n)return;let m={variant:n.variant,product:t,selections:s,quantity:1};i(m);let d=e.map(w=>{let et=s[w.id],O=u[w.id]?.find(rt=>rt.id===et);return O?`${w.name.toLowerCase()} ${O.value.toLowerCase()}`:null}).filter(Boolean).join(", "),g=d?`Added ${t.name} (${d}) to cart!`:`Added ${t.name} to cart!`;at.success(g)};return C("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden flex flex-col transition-transform duration-300 hover:scale-105",children:[C("div",{className:"relative",children:[f("img",{src:t.images[c],alt:`${t.name} - view ${c+1}`,className:"w-full h-80 object-cover"}),t.images.length>1&&f("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex space-x-2",children:t.images.map((m,d)=>f("button",{onClick:()=>l(d),className:`h-2 w-2 rounded-full transition-colors ${c===d?"bg-white":"bg-white/50 hover:bg-white"}`,"aria-label":`View image ${d+1}`},d))})]}),C("div",{className:"p-6 flex flex-col flex-grow",children:[f("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),f("p",{className:"text-lg font-semibold text-brand-teal mt-1",children:X()}),f("p",{className:"text-gray-600 mt-2",children:t.description}),f("div",{className:"mt-4 space-y-4",children:e.map(m=>C("div",{children:[C("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[m.name,m.required&&f("span",{className:"text-red-500 ml-1",children:"*"})]}),C("select",{value:s[m.id]||"",onChange:d=>J(m.id,d.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-blue focus:border-transparent",required:m.required,children:[C("option",{value:"",children:["Select ",m.name]}),(u[m.id]||[]).map(d=>f("option",{value:d.id,children:d.value},d.id))]})]},m.id))}),n&&n.variant.inventory_tracking&&f("div",{className:"mt-2",children:f("p",{className:`text-sm ${n.variant.inventory_quantity>0?n.variant.inventory_quantity<=5?"text-yellow-600":"text-green-600":"text-red-600"}`,children:n.variant.inventory_quantity>0?n.variant.inventory_quantity<=5?`Only ${n.variant.inventory_quantity} left in stock`:`${n.variant.inventory_quantity} in stock`:"Out of stock"})}),f("button",{onClick:tt,disabled:T(),className:`mt-4 w-full font-bold py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue ${T()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-opacity-90"}`,children:Z()})]})]})},$=nt;import{jsx as h,jsxs as A}from"react/jsx-runtime";var ot=({addToCart:r})=>{let[i,t]=q([]),[e,o]=q(!0),[c,l]=q(null);it(()=>{s()},[]);let s=async()=>{try{o(!0);let a=await N.getAllProductsWithVariants();t(a),l(null)}catch(a){console.error("Error loading products:",a),l("Failed to load products. Please try again later.")}finally{o(!1)}};return e?A("div",{className:"text-center py-12",children:[h("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"}),h("p",{className:"mt-2 text-gray-600",children:"Loading products..."})]}):c?A("div",{className:"text-center py-12",children:[h("p",{className:"text-red-600 mb-4",children:c}),h("button",{onClick:s,className:"bg-brand-blue text-white px-4 py-2 rounded-md hover:bg-opacity-90 transition-colors",children:"Try Again"})]}):i.length===0?h("div",{className:"text-center py-12",children:h("p",{className:"text-gray-600",children:"No products available at the moment."})}):A("div",{children:[h("h2",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:"Our Gear"}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:i.map(a=>h($,{productWithVariants:a,addToCart:r},a.product.id))})]})},D=ot;import ut,{useEffect as mt,useMemo as pt}from"react";import{jsx as y,jsxs as _}from"react/jsx-runtime";var st=({item:r,onRemove:i,onUpdateQuantity:t})=>{let e=s=>{let a=parseInt(s.target.value,10);!isNaN(a)&&a>0&&t(r.variant.id,a)},o=()=>t(r.variant.id,r.quantity+1),c=()=>{r.quantity>1?t(r.variant.id,r.quantity-1):i(r.variant.id)},l=()=>{let s=Object.values(r.selections);return s.length>0?`${r.product.name} - ${s.join(" - ")}`:r.product.name};return _("div",{className:"flex items-center space-x-4 border-b pb-4",children:[y("img",{src:r.product.images[0],alt:r.product.name,className:"w-20 h-20 object-cover rounded-md"}),_("div",{className:"flex-grow",children:[y("h4",{className:"font-bold",children:l()}),_("p",{className:"text-xs text-gray-500 mb-1",children:["SKU: ",r.variant.sku]}),y("p",{className:"text-sm text-gray-600",children:new Intl.NumberFormat("en-US",{style:"currency",currency:r.variant.currency}).format(r.variant.price/100)}),Object.keys(r.selections).length>0&&y("div",{className:"text-xs text-gray-500 mt-1",children:Object.entries(r.selections).map(([s,a])=>y("span",{className:"inline-block mr-2",children:a},s))}),_("div",{className:"flex items-center mt-2",children:[y("button",{onClick:c,className:"w-6 h-6 border rounded-l-md hover:bg-gray-50 flex items-center justify-center",children:"-"}),y("input",{type:"number",value:r.quantity,onChange:e,className:"w-10 h-6 text-center border-t border-b focus:outline-none",min:"1"}),y("button",{onClick:o,className:"w-6 h-6 border rounded-r-md hover:bg-gray-50 flex items-center justify-center",children:"+"})]})]}),_("div",{className:"text-right",children:[y("p",{className:"font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:r.variant.currency}).format(r.variant.price*r.quantity/100)}),y("button",{onClick:()=>i(r.variant.id),className:"text-sm text-red-500 hover:underline mt-1",children:"Remove"})]})]})},F=st;import{jsx as B}from"react/jsx-runtime";var ct=()=>B("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:B("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),M=ct;import{loadStripe as lt}from"@stripe/stripe-js";var L=window.STRIPE_PUBLISHABLE_KEY||"";L.startsWith("pk_")||console.error("Stripe publishable key is not set or is invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file.");var dt=lt(L),U=async r=>{let i=await dt;if(!i){console.error("Stripe.js has not loaded yet."),alert("Error: Payment system is not available. Please try again later.");return}if(!L.startsWith("pk_")){console.error("Stripe publishable key is not defined or invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file."),alert("Error: Payment system is not configured. Please contact support.");return}let t=r.filter(o=>!o.price||!o.price.startsWith("price_"));if(t.length>0){console.error("Some items don't have valid Stripe price IDs:",t),alert("Error: Some items in your cart are not properly configured for checkout. Please try again or contact support.");return}let{error:e}=await i.redirectToCheckout({lineItems:r,mode:"payment",successUrl:`${window.location.origin}?session_id={CHECKOUT_SESSION_ID}`,cancelUrl:window.location.origin});e&&(console.error("Stripe checkout error:",e),alert(`An error occurred during checkout: ${e.message}`))};import{Fragment as j,jsx as v,jsxs as x}from"react/jsx-runtime";var ft=({isOpen:r,onClose:i,items:t,removeFromCart:e,updateQuantity:o,getTotalPrice:c})=>{let[l,s]=ut.useState(!1);mt(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[r]);let a=pt(()=>c()/100,[c]),n=async()=>{s(!0);let p=t.map(u=>({price:u.variant.stripe_price_id,quantity:u.quantity}));await U(p),s(!1)};return x(j,{children:[v("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity duration-300 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i,"aria-hidden":"true"}),v("div",{className:`fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform transition-transform duration-300 ${r?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"cart-heading",children:x("div",{className:"flex flex-col h-full",children:[x("div",{className:"flex justify-between items-center p-6 border-b",children:[v("h2",{id:"cart-heading",className:"text-2xl font-bold text-brand-blue",children:"Shopping Cart"}),x("button",{onClick:i,className:"text-gray-500 hover:text-gray-800 transition-colors",children:[v(M,{}),v("span",{className:"sr-only",children:"Close cart"})]})]}),t.length===0?x("div",{className:"flex-grow flex flex-col justify-center items-center text-center p-6",children:[v("p",{className:"text-gray-600 text-lg",children:"Your cart is empty."}),v("button",{onClick:i,className:"mt-4 text-brand-teal font-semibold hover:underline",children:"Continue Shopping"})]}):x(j,{children:[v("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:t.map(p=>v(F,{item:p,onRemove:e,onUpdateQuantity:o},p.variant.id))}),x("div",{className:"p-6 border-t space-y-4",children:[x("div",{className:"flex justify-between font-bold text-lg",children:[v("span",{children:"Subtotal"}),v("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)})]}),v("button",{onClick:n,disabled:l,className:"w-full bg-brand-blue text-white font-bold py-3 px-4 rounded-md hover:bg-opacity-90 transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed",children:l?"Processing...":"Proceed to Checkout"})]})]})]})})]})},H=ft;import{useState as vt,useCallback as P}from"react";var K=()=>{let[r,i]=vt([]),t=P(a=>{i(n=>n.find(u=>u.variant.id===a.variant.id)?n.map(u=>u.variant.id===a.variant.id?{...u,quantity:u.quantity+a.quantity}:u):[...n,a])},[]),e=P(a=>{i(n=>n.filter(p=>p.variant.id!==a))},[]),o=P((a,n)=>{if(n<=0){e(a);return}i(p=>p.map(u=>u.variant.id===a?{...u,quantity:n}:u))},[e]),c=P(()=>{i([])},[]),l=P(()=>r.reduce((a,n)=>a+n.variant.price*n.quantity,0),[r]),s=P(()=>r.reduce((a,n)=>a+n.quantity,0),[r]);return{items:r,addToCart:t,removeFromCart:e,updateQuantity:o,clearCart:c,getTotalPrice:l,getTotalItems:s}};import{jsx as V,jsxs as xt}from"react/jsx-runtime";var ht=()=>{let[r,i]=yt(!1),t=K();return gt(()=>{let e=document.getElementById("header-cart-btn"),o=document.getElementById("cart-count");if(e){let c=()=>i(!0);return e.addEventListener("click",c),o&&(o.textContent=t.getTotalItems().toString(),t.getTotalItems()>0?o.classList.remove("hidden"):o.classList.add("hidden")),()=>{e.removeEventListener("click",c)}}},[t.getTotalItems]),xt("div",{className:"font-sans antialiased text-gray-800",children:[V(bt,{position:"top-right",toastOptions:{style:{background:"#004a8f",color:"white",fontSize:"16px",fontWeight:"600",padding:"16px 20px",borderRadius:"12px",boxShadow:"0 10px 25px rgba(0, 74, 143, 0.3)"}},duration:4e3}),V("main",{children:V(D,{addToCart:t.addToCart})}),V(H,{isOpen:r,onClose:()=>i(!1),...t})]})},Y=ht;import{jsx as Q}from"react/jsx-runtime";var z=document.getElementById("merch-root");if(!z)throw new Error("Could not find root element to mount to");var Pt=Ct.createRoot(z);Pt.render(Q(wt.StrictMode,{children:Q(Y,{})}));
