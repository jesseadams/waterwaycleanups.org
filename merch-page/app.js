import vt from"react";import yt from"react-dom/client";import{useState as pt}from"react";import{useState as R,useEffect as rt}from"react";import{useState as S,useEffect as M}from"react";var I=null;async function g(){if(I)return I;try{let e=await fetch("/data/products.json");if(!e.ok)throw new Error("Failed to load products data");return I=await e.json(),I}catch(e){throw console.error("Error loading products data:",e),e}}var q=class{async getAllProducts(){return(await g()).products.filter(t=>t.status==="active")}async getProduct(o){return(await g()).products.find(a=>a.id===o&&a.status==="active")||null}async getProductWithVariants(o){let t=await g(),a=t.products.find(c=>c.id===o&&c.status==="active");if(!a)return null;let s=t.dimensions.filter(c=>c.product_id===o).sort((c,i)=>c.display_order-i.display_order).map(c=>({...c,values:t.dimension_values.filter(i=>i.dimension_id===c.id&&i.active).sort((i,r)=>i.display_order-r.display_order)})),l=t.variants.filter(c=>c.product_id===o&&c.active).map(c=>({...c,attributes:t.variant_attributes.filter(i=>i.variant_id===c.id)}));return{product:a,dimensions:s,variants:l}}async getAllProductsWithVariants(){let t=(await g()).products.filter(s=>s.status==="active"),a=[];for(let s of t){let l=await this.getProductWithVariants(s.id);l&&a.push(l)}return a}async getVariant(o){return(await g()).variants.find(a=>a.id===o&&a.active)||null}async getVariantWithProduct(o){let t=await g(),a=t.variants.find(l=>l.id===o&&l.active);if(!a)return null;let s=t.products.find(l=>l.id===a.product_id&&l.status==="active");return s?{variant:a,product:s}:null}async findVariantBySelections(o,t){let a=await g(),s=a.variants.filter(l=>l.product_id===o&&l.active);for(let l of s){let c=a.variant_attributes.filter(r=>r.variant_id===l.id),i=!0;for(let[r,n]of Object.entries(t))if(!c.some(d=>d.dimension_id===r&&d.dimension_value_id===n)){i=!1;break}if(i&&Object.keys(t).length===c.length)return{variant:l,selections:t}}return null}async getAvailableValuesForDimension(o,t,a){let s=await g(),c=s.variants.filter(r=>r.product_id===o&&r.active).filter(r=>{let n=s.variant_attributes.filter(p=>p.variant_id===r.id);for(let[p,d]of Object.entries(a)){if(p===t)continue;if(!n.some(k=>k.dimension_id===p&&k.dimension_value_id===d))return!1}return!0}),i=new Set;for(let r of c){let p=s.variant_attributes.filter(d=>d.variant_id===r.id).find(d=>d.dimension_id===t);p&&i.add(p.dimension_value_id)}return s.dimension_values.filter(r=>r.dimension_id===t&&r.active&&i.has(r.id)).sort((r,n)=>r.display_order-n.display_order)}async checkInventory(o){let a=(await g()).variants.find(s=>s.id===o&&s.active);return a?a.inventory_tracking?{available:a.inventory_quantity>0,quantity:a.inventory_quantity}:{available:!0,quantity:1/0}:{available:!1,quantity:0}}},N=new q;import{jsx as f,jsxs as w}from"react/jsx-runtime";var et=({productWithVariants:e,addToCart:o})=>{let{product:t,dimensions:a,variants:s}=e,[l,c]=S(0),[i,r]=S({}),[n,p]=S(null),[d,O]=S({});M(()=>{k()},[i]),M(()=>{Object.keys(i).length===a.length?G():p(null)},[i,a]);let k=async()=>{let u={};for(let m of a){let x={...i};delete x[m.id];let V=await N.getAvailableValuesForDimension(t.id,m.id,x);u[m.id]=V}O(u)},G=async()=>{let u=await N.findVariantBySelections(t.id,i);p(u)},J=(u,m)=>{r(x=>({...x,[u]:m}))},X=()=>{if(n)return new Intl.NumberFormat("en-US",{style:"currency",currency:n.variant.currency}).format(n.variant.price/100);let u=s.map(V=>V.price),m=Math.min(...u),x=Math.max(...u);return m===x?new Intl.NumberFormat("en-US",{style:"currency",currency:s[0].currency}).format(m/100):`${new Intl.NumberFormat("en-US",{style:"currency",currency:s[0].currency}).format(m/100)} - ${new Intl.NumberFormat("en-US",{style:"currency",currency:s[0].currency}).format(x/100)}`},W=()=>n?n.variant.inventory_tracking?n.variant.inventory_quantity<=0:!1:!0,Z=()=>{if(!n){let u=a.filter(m=>!i[m.id]).map(m=>m.name);return u.length>0?`Select ${u.join(", ")}`:"Select Options"}return n.variant.inventory_tracking&&n.variant.inventory_quantity<=0?"Out of Stock":"Add to Cart"},tt=()=>{if(!n)return;let u={variant:n.variant,product:t,selections:i,quantity:1};o(u)};return w("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden flex flex-col transition-transform duration-300 hover:scale-105",children:[w("div",{className:"relative",children:[f("img",{src:t.images[l],alt:`${t.name} - view ${l+1}`,className:"w-full h-80 object-cover"}),t.images.length>1&&f("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex space-x-2",children:t.images.map((u,m)=>f("button",{onClick:()=>c(m),className:`h-2 w-2 rounded-full transition-colors ${l===m?"bg-white":"bg-white/50 hover:bg-white"}`,"aria-label":`View image ${m+1}`},m))})]}),w("div",{className:"p-6 flex flex-col flex-grow",children:[f("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),f("p",{className:"text-lg font-semibold text-brand-teal mt-1",children:X()}),f("p",{className:"text-gray-600 mt-2",children:t.description}),f("div",{className:"mt-4 space-y-4",children:a.map(u=>w("div",{children:[w("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[u.name,u.required&&f("span",{className:"text-red-500 ml-1",children:"*"})]}),w("select",{value:i[u.id]||"",onChange:m=>J(u.id,m.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-blue focus:border-transparent",required:u.required,children:[w("option",{value:"",children:["Select ",u.name]}),(d[u.id]||[]).map(m=>f("option",{value:m.id,children:m.value},m.id))]})]},u.id))}),n&&n.variant.inventory_tracking&&f("div",{className:"mt-2",children:f("p",{className:`text-sm ${n.variant.inventory_quantity>0?n.variant.inventory_quantity<=5?"text-yellow-600":"text-green-600":"text-red-600"}`,children:n.variant.inventory_quantity>0?n.variant.inventory_quantity<=5?`Only ${n.variant.inventory_quantity} left in stock`:`${n.variant.inventory_quantity} in stock`:"Out of stock"})}),f("button",{onClick:tt,disabled:W(),className:`mt-4 w-full font-bold py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-blue ${W()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-opacity-90"}`,children:Z()})]})]})},F=et;import{jsx as b,jsxs as E}from"react/jsx-runtime";var at=({addToCart:e})=>{let[o,t]=R([]),[a,s]=R(!0),[l,c]=R(null);rt(()=>{i()},[]);let i=async()=>{try{s(!0);let r=await N.getAllProductsWithVariants();t(r),c(null)}catch(r){console.error("Error loading products:",r),c("Failed to load products. Please try again later.")}finally{s(!1)}};return a?E("div",{className:"text-center py-12",children:[b("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"}),b("p",{className:"mt-2 text-gray-600",children:"Loading products..."})]}):l?E("div",{className:"text-center py-12",children:[b("p",{className:"text-red-600 mb-4",children:l}),b("button",{onClick:i,className:"bg-brand-blue text-white px-4 py-2 rounded-md hover:bg-opacity-90 transition-colors",children:"Try Again"})]}):o.length===0?b("div",{className:"text-center py-12",children:b("p",{className:"text-gray-600",children:"No products available at the moment."})}):E("div",{children:[b("h2",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:"Our Gear"}),b("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:o.map(r=>b(F,{productWithVariants:r,addToCart:e},r.product.id))})]})},D=at;import ct,{useEffect as lt,useMemo as dt}from"react";import{jsx as y,jsxs as _}from"react/jsx-runtime";var nt=({item:e,onRemove:o,onUpdateQuantity:t})=>{let a=i=>{let r=parseInt(i.target.value,10);!isNaN(r)&&r>0&&t(e.variant.id,r)},s=()=>t(e.variant.id,e.quantity+1),l=()=>{e.quantity>1?t(e.variant.id,e.quantity-1):o(e.variant.id)},c=()=>{let i=Object.values(e.selections);return i.length>0?`${e.product.name} - ${i.join(" - ")}`:e.product.name};return _("div",{className:"flex items-center space-x-4 border-b pb-4",children:[y("img",{src:e.product.images[0],alt:e.product.name,className:"w-20 h-20 object-cover rounded-md"}),_("div",{className:"flex-grow",children:[y("h4",{className:"font-bold",children:c()}),_("p",{className:"text-xs text-gray-500 mb-1",children:["SKU: ",e.variant.sku]}),y("p",{className:"text-sm text-gray-600",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.variant.currency}).format(e.variant.price/100)}),Object.keys(e.selections).length>0&&y("div",{className:"text-xs text-gray-500 mt-1",children:Object.entries(e.selections).map(([i,r])=>y("span",{className:"inline-block mr-2",children:r},i))}),_("div",{className:"flex items-center mt-2",children:[y("button",{onClick:l,className:"w-6 h-6 border rounded-l-md hover:bg-gray-50 flex items-center justify-center",children:"-"}),y("input",{type:"number",value:e.quantity,onChange:a,className:"w-10 h-6 text-center border-t border-b focus:outline-none",min:"1"}),y("button",{onClick:s,className:"w-6 h-6 border rounded-r-md hover:bg-gray-50 flex items-center justify-center",children:"+"})]})]}),_("div",{className:"text-right",children:[y("p",{className:"font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:e.variant.currency}).format(e.variant.price*e.quantity/100)}),y("button",{onClick:()=>o(e.variant.id),className:"text-sm text-red-500 hover:underline mt-1",children:"Remove"})]})]})},$=nt;import{jsx as j}from"react/jsx-runtime";var ot=()=>j("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:j("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),U=ot;import{loadStripe as it}from"@stripe/stripe-js";var A=window.STRIPE_PUBLISHABLE_KEY||"";A.startsWith("pk_")||console.error("Stripe publishable key is not set or is invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file.");var st=it(A),B=async e=>{let o=await st;if(!o){console.error("Stripe.js has not loaded yet."),alert("Error: Payment system is not available. Please try again later.");return}if(!A.startsWith("pk_")){console.error("Stripe publishable key is not defined or invalid. Please set window.STRIPE_PUBLISHABLE_KEY in your HTML file."),alert("Error: Payment system is not configured. Please contact support.");return}let t=e.filter(s=>!s.price||!s.price.startsWith("price_"));if(t.length>0){console.error("Some items don't have valid Stripe price IDs:",t),alert("Error: Some items in your cart are not properly configured for checkout. Please try again or contact support.");return}let{error:a}=await o.redirectToCheckout({lineItems:e,mode:"payment",successUrl:`${window.location.origin}?session_id={CHECKOUT_SESSION_ID}`,cancelUrl:window.location.origin});a&&(console.error("Stripe checkout error:",a),alert(`An error occurred during checkout: ${a.message}`))};import{Fragment as H,jsx as v,jsxs as h}from"react/jsx-runtime";var ut=({isOpen:e,onClose:o,items:t,removeFromCart:a,updateQuantity:s,getTotalPrice:l})=>{let[c,i]=ct.useState(!1);lt(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[e]);let r=dt(()=>l()/100,[l]),n=async()=>{i(!0);let p=t.map(d=>({price:d.variant.stripe_price_id,quantity:d.quantity}));await B(p),i(!1)};return h(H,{children:[v("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:o,"aria-hidden":"true"}),v("div",{className:`fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform transition-transform duration-300 ${e?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"cart-heading",children:h("div",{className:"flex flex-col h-full",children:[h("div",{className:"flex justify-between items-center p-6 border-b",children:[v("h2",{id:"cart-heading",className:"text-2xl font-bold text-brand-blue",children:"Shopping Cart"}),h("button",{onClick:o,className:"text-gray-500 hover:text-gray-800 transition-colors",children:[v(U,{}),v("span",{className:"sr-only",children:"Close cart"})]})]}),t.length===0?h("div",{className:"flex-grow flex flex-col justify-center items-center text-center p-6",children:[v("p",{className:"text-gray-600 text-lg",children:"Your cart is empty."}),v("button",{onClick:o,className:"mt-4 text-brand-teal font-semibold hover:underline",children:"Continue Shopping"})]}):h(H,{children:[v("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:t.map(p=>v($,{item:p,onRemove:a,onUpdateQuantity:s},p.variant.id))}),h("div",{className:"p-6 border-t space-y-4",children:[h("div",{className:"flex justify-between font-bold text-lg",children:[v("span",{children:"Subtotal"}),v("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r)})]}),v("button",{onClick:n,disabled:c,className:"w-full bg-brand-blue text-white font-bold py-3 px-4 rounded-md hover:bg-opacity-90 transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?"Processing...":"Proceed to Checkout"})]})]})]})})]})},K=ut;import{useState as mt,useCallback as P}from"react";var Y=()=>{let[e,o]=mt([]),t=P(r=>{o(n=>n.find(d=>d.variant.id===r.variant.id)?n.map(d=>d.variant.id===r.variant.id?{...d,quantity:d.quantity+r.quantity}:d):[...n,r])},[]),a=P(r=>{o(n=>n.filter(p=>p.variant.id!==r))},[]),s=P((r,n)=>{if(n<=0){a(r);return}o(p=>p.map(d=>d.variant.id===r?{...d,quantity:n}:d))},[a]),l=P(()=>{o([])},[]),c=P(()=>e.reduce((r,n)=>r+n.variant.price*n.quantity,0),[e]),i=P(()=>e.reduce((r,n)=>r+n.quantity,0),[e]);return{items:e,addToCart:t,removeFromCart:a,updateQuantity:s,clearCart:l,getTotalPrice:c,getTotalItems:i}};import{jsx as C,jsxs as L}from"react/jsx-runtime";var ft=()=>{let[e,o]=pt(!1),t=Y();return L("div",{className:"font-sans antialiased text-gray-800",children:[L("div",{className:"flex justify-between items-center mb-8",children:[C("h1",{className:"text-4xl font-bold text-brand-blue",children:"Merchandise"}),L("button",{onClick:()=>o(!0),className:"relative text-gray-600 hover:text-brand-teal transition-colors duration-200 bg-white rounded-lg p-3 shadow-md","aria-label":`Open cart with ${t.getTotalItems()} items`,children:[C("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m4.5-6h6"})}),t.getTotalItems()>0&&C("span",{className:"absolute -top-2 -right-2 bg-brand-teal text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:t.getTotalItems()})]})]}),C("main",{children:C(D,{addToCart:t.addToCart})}),C(K,{isOpen:e,onClose:()=>o(!1),...t})]})},Q=ft;import{jsx as z}from"react/jsx-runtime";console.log("Loading React app...");console.log("Modules imported successfully");var T=document.getElementById("merch-root");console.log("Root element:",T);if(!T)throw console.error("Could not find root element to mount to"),new Error("Could not find root element to mount to");console.log("Creating React root...");var gt=yt.createRoot(T);console.log("Rendering app...");gt.render(z(vt.StrictMode,{children:z(Q,{})}));console.log("App rendered successfully");
